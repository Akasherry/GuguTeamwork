<!--pages/process/taskList/task.wxml-->
<wxs src="../../../wxs/sub.wxs" module="tools" />

<view wx:if='{{!show}}'>
  <view id="title">
    <text>任务信息</text>
  </view>
  <view>名称：{{title}}</view>
  <view>发布者：{{pusher}}</view>
  <view>内容：{{content}}</view>
  <view>状态：{{status}}</view>
  <view>发布日期：{{pushDate}}</view>
  <view>截止日期：{{deadLine}}</view>
  <view>优先级：{{urgency}}</view>
</view>
<view wx:else>
  <view>
    <modal title="编辑任务信息" confirm-text="确认" hidden='{{!isEdit}}' cancel-text="取消" bindconfirm="editConfirm" bindcancel="editCancel">
      <label>
        <view class="">
          <input class="input" bindinput="" placeholder="名称" data-type='Title' value="{{edit_info['Title']}}" bindblur='editChange' />
          <input class="input" bindinput="" placeholder="内容" data-type='Content' value="{{edit_info['Content']}} " bindblur='editChange' />
          <input class="input" bindinput="" placeholder="截止日期" data-type='DeadLine' value="{{edit_info['DeadLine']}} " bindblur='editChange' />
        </view>
      </label>
    </modal>
  </view>

  <view class="st-radius-view" style='margin-top:40rpx'>
    <view hidden="{{isEdit}}">
      <canvas-drag id="canvas-drag" bind:onSelectedChange='onSelectedChange' bind:onRefresh='onInitByTree' graph="{{graph}}" width="700" height="750"></canvas-drag>
    </view>
    <image hidden="{{!isEdit}}" src="{{canvasImg}}" style="width:700rpx;height:750rpx;"></image>
  </view>
  <!-- <view class="btn" bindtap="onAddImage">添加图片</view>
<view class="btn" bindtap="onAddTest">添加测试图片</view>
<view class="btn" bindtap="onAddText">添加文字</view>
<view class="btn" bindtap="onExport">导出图片</view>
<view class="btn" bindtap="onChangeColor">改变文字颜色</view>
<view class="btn" bindtap="onChangeBgColor">改变背景颜色</view>
<view class="btn" bindtap="onChangeBgImage">改变背景照片</view>
<view class="btn" bindtap="onExportJSON">导出模板</view>
<view class="btn" bindtap="onImport">导入默认模板</view> -->
  <view class="vertical">

    <view class="vertical" style="margin:30rpx 45rpx 30rpx 45rpx;height:100rpx">
      <view hidden='{{!isSelected}}'>
        <view class="horizontal">
          <view class="horizontal" style="width:50%">
            <text>任务名：</text>
            <text>{{selected_node['Task']['Title']}}</text>
          </view>
          <text style="width:50%;text-align:right" class="st-date">{{selected_node['Task']['Pusher']}}创建于{{tools.sub(selected_node['Task']['PushDate'])}}</text>
        </view>
        <view class="horizontal">
          <text style="width:30%">紧急程度：{{selected_node['Task']['Urgency']}}</text>
          <text style="width:70%;text-align:right" class="st-date">截止日期:{{selected_node['Task']['DeadLine']}}</text>
        </view>
        <view class="horizontal">
          <text style="width:100%">{{selected_node['Task']['Content']}}</text>
        </view>
        <!-- <text>{{text_selected_node}}</text> -->
      </view>
    </view>

    <view style='margin-left:45rpx;margin-right:45rpx;margin-right:45rpx'>
      <view class="horizontal" style="">
        <view class="btn" bindtap="onClearCanvas">清空</view>
        <!-- <view class="btn" bindtap='onSetData'>连接服务器以设置data数据</view> -->
        <view class="btn" bindtap="onInitByTree">刷新</view>
        <view class="btn" bindtap="onDoDel">执行删除</view>
      </view>
      <view class="horizontal" style="">
        <view class="btn" bindtap="onEditNode" hidden='{{!isSelected}}'>编辑</view>
        <view class="btn" bindtap="onAddNode" hidden='{{!isSelected}}'>添加</view>
        <view class="btn" bindtap="onDelNode" hidden='{{!isSelected}}'>删除/恢复</view>
      </view>
    </view>
  </view>
</view>